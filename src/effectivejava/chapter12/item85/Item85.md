---
# 아이템 85. 자바 직렬화의 대안을 찾아라.

---
## 직렬화
- 직렬화 : 객체 -> 바이트
- 역직렬화 : 바이트 -> 객체(String)
- 객체를 바이트 스트림으로 인코딩하고 그 바이트 스트림으로부터 다시 객체를 재구성하는 매커니즘이다.
- 객체의 내용을 파일 혹은 네트워크를 통하여 byte stream으로 입출력한다.
- java.io.Serializable 인터페이스를 구현해야만 직렬화가 가능하다.
- FileInputStream, ObjectInputStream 등등을 활용해서 양껏 데이터를 읽어들이는 방법

---
## 직렬화의 문제점
- 공격 범위가 너무 넓고 지속적으로 더 넓어져 방어하기 어렵다.
	- 신뢰할 수 없는 스트림을 역직렬화하면 원격 코드 실행, 서비스 거부 등등의 공격으로 이어질 수 있다.
- 가젯(gadget) : 역직렬화 과정에서 호출되어 잠재적으로 위험한 동작을 일으키는 메서드

자바 a 플랫폼 : 객체 A -> 바이트
자바 b 플랫폼 : 바이트 -> 객체 B
---
## 직렬화의 대안
1. 크로스 플랫폼 구조화된 데이터 표현(cross-platform structured-data representation)을 사용한다.
	- JSON, Protocol Buffers(protobuf)
2. 신뢰할 수 없는 데이터는 절대로 역직렬화하지 않는다.
3. 객체 역직렬화 필터링을 사용한다.
	- java.io.ObjectInputFilter
	- 객체 역직렬화 필터링은 데이터 스트림이 역직렬화하기 전에 필터를 설치하는 기능이다.
	- 블랙 리스트 방식과 화이트 리스트 방식이 있는데, 당연하게도 화이트 리스트 방식이 추천된다.

---
## 핵심정리
- 직렬화는 위험하니 반드시 피해야 한다. 시스템을 밑바닥부터 설계한다면 JSON 이나 Protocol Buffer 같은 대안을 사용한다.