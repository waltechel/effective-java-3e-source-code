---

# 아이템 48. 스트림 병렬화는 주의해서 사용하라.

---
## 스트림 병렬화는 주의해서 사용하라
- 스레드, 동기화, wait / notify -> .... -> parallel in stream

- 병렬 프로그래밍 시에는 안전성과 데드락을 주의하여야 한다.

- 환경이 아무리 좋더라도 데이터 소스가 Stream.iterate거나 중간 연산자로 limit을 쓰면 파이프라인 병렬화로는 성능 개선을 기대할 수 없다.

- 파이프라인 병렬화는 limit을 다룰 때 CPU 코어가 남는다면 원소를 몇 개 더 처리한 후 제한된 개수의 이후의 결과를 버려도 아무런 해가 없다고 가정한다. 만약 limit 개수 이상의 원소를 계산하는데 너무 많은 시간이 걸린다면 큰일난다..

- 병렬 스트림에서 중요한 것은 참조 지역성이다.
	- 참조 지역성 : 메모리상에서 이웃의 원소들이 얼마나 함께 위치한 정도를 의미한다.
	- 참조 지역성이 가장 좋은 것은 primitive type 배열이다.
- 종단 연산도 병렬화 작업 중 상당한 비중을 차지하는데,
	- 순차적인 연산이라면 파이프라인 병렬 수행의 효과느니 제한된다.
	- 병렬화에 가장 적합한 것은 reduction이다.

- 대체로 스트림의 소스가 ArrayList, HashMap, HashSet, ConcurrentHashMap, 의 인스턴스거나 배열, int 범위, long 범위일 때 병렬화의 효과가 가장 좋다.

---
## 핵심 정리
- 스트림의 병렬화는 성능 향상이 목적이다
- 실제 성능향상이 이루어지는지 확인을 무조건 하길 바란다.
